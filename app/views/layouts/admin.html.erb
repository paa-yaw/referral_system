<!doctype html>
<html lang="en">
<head>
	<title>ReferralSystem</title>
	<%= stylesheet_link_tag 'admin/application', media: 'all' %>
	<%= javascript_include_tag 'admin/application' %>
	<link href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" rel="stylesheet">
	<link href='https://fonts.googleapis.com/css?family=Roboto:400,700,300|Material+Icons' rel='stylesheet' type='text/css'>
	<%= csrf_meta_tags %>
	<script type='text/javascript'>
		(function (d, t) {
			var bh = d.createElement(t), s = d.getElementsByTagName(t)[0];
			bh.type = 'text/javascript';
			bh.src = 'https://www.bugherd.com/sidebarv2.js?apikey=ae7xuqxags43ixcps5x7mq';
			s.parentNode.insertBefore(bh, s);
		})(document, 'script');
	</script>
</head>

<body>
<div class="wrapper">

		<div class="sidebar" data-color="purple" data-image="../assets/img/sidebar-1.jpg">
			<!--
		        Tip 1: You can change the color of the sidebar using: data-color="purple | blue | green | orange | red"

		        Tip 2: you can also add an image using data-image tag
		    -->

		    <div class="logo">
		    	<span class="logo1"><strong>BETA</strong></span>
		    	<%= link_to admin_dashboard_url do %>
		    	  <%= image_tag("logo.jpeg", height: "90px", width: "220px") %>
		    	<% end %>  
	    	</div>

		    <div class="sidebar-wrapper">
		    	<ul class="nav">
		    		<li class="active">
		    			<%= link_to admin_dashboard_url do %>
		    			  <i class="material-icons">dashboard</i>
		    				<p>Dashboard</p>  
		    			<% end %>	
		    		</li>
		    		<% if current_user.admin? %>
		    		<li>
     	    		  <%= link_to edit_user_registration_url do %>
		    		    <i class="material-icons">person</i>
		    				<p>Your Profile</p>
		    		  <% end %>
		    		</li>
		    		<% end %>
		    		<% if current_user.super_admin? %>
		    		<li>
		    		  <%= link_to new_admin_admin_user_url do %>
		    		    <i class="material-icons">person</i>
		    		    <p>Create Admin</p>
		    		  <% end %>	  
		    		</li>
		    		<li>
		    		  <%= link_to admin_admin_users_url do %>
		    		    <i class="material-icons">people</i>
		    		    <p>Admins</p>
		    		  <% end %>	  
		    		</li>
		    		<li>
		    		  <%= link_to admin_users_url do %>
		    		    <i class="material-icons">people</i>
		    		    <p>
		    		      Users
		    		      <%# unless @unapproved_users.empty? %>
		    		     <!--  <button class="btn btn-info btn-round btn-xs">
		    		      	<%#= @unapproved_users.count %>
		    		      </button> -->
		    		      <%# end %>
		    		    </p>
		    		  <% end %>	  
		    		</li>
		    		<% end %>
		    		<li>
		    		<% if current_user.admin? %>
		    		  <%= link_to admin_mark_all_as_seen_url do %>
		    		    <i class="material-icons">business center</i>
		    		    <p>
		    		      All Companies
		    		      <%# if @unseen_notifications.count == 0 %>
		    		      <%# else %>
		    		        <!-- <button id="company_notification" class="btn btn-danger btn-round btn-xs">
		    		          <%#= @company_notifications %>	
		    		        </button> -->
		    		      <%# end %>  
		    		    </p>
		    		  <% end %>	
		    		<% end %>
		    		</li>
		    		<li>
		    		<% if current_user.admin? %>
		    		  <%= link_to admin_job_descriptions_url do %>
		    		    <i class="material-icons">folder</i>
		    		    <p>
		    		      All Roles
		    		      <%# unless @uncompleted_roles.empty? %>
		    		        <!-- <button class="btn btn-info btn-round btn-xs">
		    		          <%#= @uncompleted_roles.count %>	
		    		        </button> -->
		    		      <%# end %>
		    		    </p>
		    		  <% end %>
		    		<% end %>	
		    		</li>
		    		<li>
		    		<% if current_user.admin? %>
		    		  <%= link_to admin_manage_all_applicants_url do %>
		    		    <i class="material-icons">people</i>
		    		    <p>
		    		      All Applicants
		    		      <%# unless @new_applicants.empty? %>
		    		       <!--  <button class="btn btn-info btn-round btn-xs">
		    		          <%#= @new_applicants.count %>	
		    		        </button> -->
		    		      <%# end %>
		    		    </p>
		    		  <% end %>
		    		<% end %>	
		    		</li>
		    		<li>
		    		<% if current_user.admin? %>
		    		  <%= link_to admin_activity_feed_url do %>
		    		    <i class="material-icons">comment</i>
		    		    <p>News Feed</p>
		    		  <% end %>	
		    		<% end %>  
		    		</li>
		    		<li>
		    		  <% if current_user.admin? %>
		    		  <%= link_to admin_messages_url(category: "received") do %>
		    		    <i class="material-icons">email</i>
		    		    <p>Messages</p>
		    		  <% end %>	
		    		<% end %>  	
		    		</li>
		    		<li>
		    		  <% if current_user.super_admin? %>
		    		  <%= link_to "#" do %>
		    		    <i class="material-icons">multiline_chart</i>
		    		    <p>Log of User Activities</p>
		    		  <% end %>  
		    		  <% end %>	
		    		</li>
		    		<li>
		    		  <% if current_user.dev? %>
		    		  <%= link_to admin_bug_reports_url do %>
		    		    <i class="material-icons">bug_report</i>
		    		    <p>Bug Report</p>
		    		  <% end %>  
		    		  <% end %>		
		    		</li>
		    	</ul>
		    </div>
		</div>

		<div class="main-panel">
			<nav class="navbar navbar-transparent navbar-absolute">
				<div class="container-fluid">
					<div class="navbar-header">
						<button type="button" class="navbar-toggle" data-toggle="collapse">
							<span class="sr-only">Toggle navigation</span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
						</button>
						<%= link_to "Admin Dashboard", admin_dashboard_url, class: "navbar-brand" %>
					</div>
					<div class="collapse navbar-collapse">
						<ul class="nav navbar-nav navbar-right">
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">
									<i class="material-icons">notifications</i>
									<% if @unseen_notifications.count == 0 %>
									<% else %>
									<span class="notification"><%= @unseen_notifications.count %></span>
									<% end %>
									<p class="hidden-lg hidden-md">Notifications</p>
								</a>
								<% if @all_notifications.any? %>
								<ul class="dropdown-menu" style="min-width: 430px;">
								  <% @all_notifications.last(10).each do |notification| %>
								  <% if_resource_exists?(notification) do %>
									<% if notification.resource_type == "Company" && notification.action == "created" %> 
									  
									  <%= render "admin/notification_partials/created_company", notification: notification %>

									<% elsif notification.resource_type == "Company" && notification.action == "updated" %>
									  
									  <%= render "admin/notification_partials/updated_company", notification: notification %>

									<% elsif notification.resource_type == "JobDescription" && (notification.action == "posted" || notification.action == "updated") %>  
									  
									  <%= render "admin/notification_partials/posted_vs_updated_job_description.html.erb", notification: notification %>

									<% elsif notification.resource_type == "JobDescription" && notification.action == "pending update" %>
									  
									  <%= render "admin/notification_partials/pending_update_jd", notification: notification %>

									<% elsif notification.resource_type == "Applicant" && notification.action == "created" %>
									  
									  <%= render "admin/notification_partials/created_applicant", notification: notification %>

									<% elsif notification.resource_type == "Applicant" && notification.action == "pending update" %>
									  
									  <%= render "admin/notification_partials/pending_update_applicant", notification: notification %>

									<% elsif notification.resource_type == "User" && notification.action == "sign up" %>
									  
									  <%= render "admin/notification_partials/user_signup", notification: notification %>
									      
									<% end %>  
									<% end %>
								  <% end %>	
								</ul>
								<% end %>
							</li>
							<li>
							  <% if current_user.admin? %>
							  <%= link_to destroy_user_session_url, method: :delete, data: { confirm: "Are you sure you want to sign out?" }, class: "btn btn-primary btn-xs btn-round" do %>
							    <i class="material-icons">person</i> 
							    Log out,
							    <%= current_user.username %>
							  <% end %>
							  <% else %>     
								<%= link_to new_user_session_url, class: "btn btn-primary btn-xs btn-round" do %>
							      <i class="material-icons">person</i>Log In
								<% end %>
							  <% end %>	
							</li>
						</ul>
					</div>
				</div>
			</nav>
			<div class="content">
				<div class="container-fluid">
					<div class="row">

					  <div id="flash">
						<% flash.each do |key, message| %>
						<div id="flash" class="alert alert-<%= key %>">
							<%= message %>
						</div>
						<% end %>
					  </div>
						<%= yield %>
					</div>
				</div>
			</div>
	
</body>
<%= javascript_include_tag "admin/jquery-3.1.0.min" %>
<%= javascript_include_tag "admin/bootstrap.min" %>
<%= javascript_include_tag "admin/material.min" %>
<%= javascript_include_tag "admin/chartist.min" %>
<%= javascript_include_tag "admin/bootstrap-notify" %>
<%= javascript_include_tag "admin/material-dashboard" %>



<script type="text/javascript">
        $('.dropdown').click(function(e) {
        	$.ajax({
        	  method: "GET",
        	  url: "/admin/notifications/mark_all_as_seen",
        	  dataType: "JSON",
        	  success: function (){
        	  	$('.notification').remove();
        	  	$("#company_notification").remove();
        	  }
        	})
        });
</script>

<script type="text/javascript">
	    	$(document).ready(function(){
	    		setTimeout(function(){
	    			$('#flash').fadeOut(5000);
	    		}, 5000);
	    	}); 	
</script>
</html>
